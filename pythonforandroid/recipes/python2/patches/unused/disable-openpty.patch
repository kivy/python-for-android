--- Python-2.7.15/Modules/posixmodule.c.orig	2017-12-29 11:14:51.668097000 +0100
+++ Python-2.7.15/Modules/posixmodule.c	2017-12-29 12:04:09.598668939 +0100
@@ -3941,54 +3941,8 @@
 static PyObject *
 posix_openpty(PyObject *self, PyObject *noargs)
 {
-    int master_fd, slave_fd;
-#ifndef HAVE_OPENPTY
-    char * slave_name;
-#endif
-#if defined(HAVE_DEV_PTMX) && !defined(HAVE_OPENPTY) && !defined(HAVE__GETPTY)
-    PyOS_sighandler_t sig_saved;
-#ifdef sun
-    extern char *ptsname(int fildes);
-#endif
-#endif
-
-#ifdef HAVE_OPENPTY
-    if (openpty(&master_fd, &slave_fd, NULL, NULL, NULL) != 0)
-        return posix_error();
-#elif defined(HAVE__GETPTY)
-    slave_name = _getpty(&master_fd, O_RDWR, 0666, 0);
-    if (slave_name == NULL)
-        return posix_error();
-
-    slave_fd = open(slave_name, O_RDWR);
-    if (slave_fd < 0)
-        return posix_error();
-#else
-    master_fd = open(DEV_PTY_FILE, O_RDWR | O_NOCTTY); /* open master */
-    if (master_fd < 0)
-        return posix_error();
-    sig_saved = PyOS_setsig(SIGCHLD, SIG_DFL);
-    /* change permission of slave */
-    if (grantpt(master_fd) < 0) {
-        PyOS_setsig(SIGCHLD, sig_saved);
-        return posix_error();
-    }
-    /* unlock slave */
-    if (unlockpt(master_fd) < 0) {
-        PyOS_setsig(SIGCHLD, sig_saved);
-        return posix_error();
-    }
-    PyOS_setsig(SIGCHLD, sig_saved);
-    slave_name = ptsname(master_fd); /* get name of slave */
-    if (slave_name == NULL)
-        return posix_error();
-    slave_fd = open(slave_name, O_RDWR | O_NOCTTY); /* open slave */
-    if (slave_fd < 0)
-        return posix_error();
-#endif /* HAVE_OPENPTY */
-
-    return Py_BuildValue("(ii)", master_fd, slave_fd);
-
+    PyErr_SetString(PyExc_NotImplementedError, "openpty not implemented for this build");
+    return NULL;
 }
 #endif /* defined(HAVE_OPENPTY) || defined(HAVE__GETPTY) || defined(HAVE_DEV_PTMX) */
 
